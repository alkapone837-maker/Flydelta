-- Fly + Noclip Menu | Mobile & PC | Delta Compatible
-- By Alkapone üêê

local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

-- VARIABLES
local flying = false
local noclip = false
local speed = 60
local bv, bg

-- CHARACTER
local function getChar()
	return LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
end

-- UI
local gui = Instance.new("ScreenGui")
gui.Name = "FlyMenu"
gui.ResetOnSpawn = false
gui.Parent = game.CoreGui

local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 230, 0, 260)
frame.Position = UDim2.new(0.05, 0, 0.3, 0)
frame.BackgroundColor3 = Color3.fromRGB(25,25,25)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true

local corner = Instance.new("UICorner", frame)
corner.CornerRadius = UDim.new(0, 16)

local title = Instance.new("TextLabel", frame)
title.Size = UDim2.new(1, 0, 0, 45)
title.BackgroundTransparency = 1
title.Text = "ü™Ω Fly Menu"
title.TextColor3 = Color3.fromRGB(0,255,180)
title.Font = Enum.Font.GothamBold
title.TextSize = 22

-- BUTTON CREATOR
local function createButton(text, posY, color)
	local btn = Instance.new("TextButton", frame)
	btn.Size = UDim2.new(0.85, 0, 0, 42)
	btn.Position = UDim2.new(0.075, 0, 0, posY)
	btn.BackgroundColor3 = color
	btn.Text = text
	btn.TextColor3 = Color3.new(1,1,1)
	btn.Font = Enum.Font.GothamBold
	btn.TextSize = 16
	btn.AutoButtonColor = true
	local c = Instance.new("UICorner", btn)
	c.CornerRadius = UDim.new(0, 12)
	return btn
end

local flyBtn = createButton("FLY : OFF", 55, Color3.fromRGB(0,170,255))
local noclipBtn = createButton("NOCLIP : OFF", 105, Color3.fromRGB(255,90,90))
local speedUp = createButton("SPEED +", 155, Color3.fromRGB(120,200,120))
local speedDown = createButton("SPEED -", 205, Color3.fromRGB(200,120,120))

-- FLY FUNCTIONS
local function startFly()
	local char = getChar()
	local hrp = char:WaitForChild("HumanoidRootPart")

	bv = Instance.new("BodyVelocity")
	bv.MaxForce = Vector3.new(1e9,1e9,1e9)
	bv.Velocity = Vector3.zero
	bv.Parent = hrp

	bg = Instance.new("BodyGyro")
	bg.MaxTorque = Vector3.new(1e9,1e9,1e9)
	bg.CFrame = hrp.CFrame
	bg.Parent = hrp

	RunService.RenderStepped:Connect(function()
		if flying and bv and bg then
			local dir = Vector3.zero
			if UIS.TouchEnabled then
				-- MOBILE: vuela hacia donde miras
				dir = Camera.CFrame.LookVector
			else
				-- PC
				if UIS:IsKeyDown(Enum.KeyCode.W) then dir += Camera.CFrame.LookVector end
				if UIS:IsKeyDown(Enum.KeyCode.S) then dir -= Camera.CFrame.LookVector end
				if UIS:IsKeyDown(Enum.KeyCode.A) then dir -= Camera.CFrame.RightVector end
				if UIS:IsKeyDown(Enum.KeyCode.D) then dir += Camera.CFrame.RightVector end
				if UIS:IsKeyDown(Enum.KeyCode.Space) then dir += Camera.CFrame.UpVector end
				if UIS:IsKeyDown(Enum.KeyCode.LeftControl) then dir -= Camera.CFrame.UpVector end
			end
			bv.Velocity = dir * speed
			bg.CFrame = Camera.CFrame
		end
	end)
end

local function stopFly()
	if bv then bv:Destroy() bv = nil end
	if bg then bg:Destroy() bg = nil end
end

-- NOCLIP LOOP
RunService.Stepped:Connect(function()
	if noclip then
		for _,v in pairs(getChar():GetDescendants()) do
			if v:IsA("BasePart") then
				v.CanCollide = false
			end
		end
	end
end)

-- BUTTON EVENTS
flyBtn.MouseButton1Click:Connect(function()
	flying = not flying
	flyBtn.Text = flying and "FLY : ON" or "FLY : OFF"
	if flying then
		startFly()
	else
		stopFly()
	end
end)

noclipBtn.MouseButton1Click:Connect(function()
	noclip = not noclip
	noclipBtn.Text = noclip and "NOCLIP : ON" or "NOCLIP : OFF"
end)

speedUp.MouseButton1Click:Connect(function()
	speed += 10
end)

speedDown.MouseButton1Click:Connect(function()
	speed = math.max(10, speed - 10)
end)
